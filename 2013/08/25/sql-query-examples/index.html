<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Ace Atienza&#039;s Web Development blog">
        <title>SQL query examples for tables with relationships</title>
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/styles.css" type="text/css">
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Google Search -->
    <script>
    (function() {
      var cx = '000861553144757390361:ilf0n_kvp6c';
      var gcse = document.createElement('script');
      gcse.type = 'text/javascript';
      gcse.async = true;
      gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
          '//www.google.com/cse/cse.js?cx=' + cx;
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(gcse, s);
    })();
    </script>
</head>
  <body>
    
    <nav class="navbar navbar-default navbar-static-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">Ace Atienza</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="active"><a href="/">Blog</a></li>
        <li ><a href="/projects">Projects</a></li>
        <li ><a href="/about">About</a></li>
      </ul>
      <form class="navbar-form navbar-right" action="/search_results" method="GET">
        <div class="form-group">
          <input class="form-control" name="q" placeholder="Search...">
        </div>
      </form>      
    </div>
  </div>
</nav>
  	<div class="container">
  		<div class="row">
  			<div class="col-sm-8 center-block">
          <article>
            <header>
              <p><span class="post-date">Aug 8, 2013</span></p>
              <h3><a href="">SQL query examples for tables with relationships</a></h3>
          	</header>
            <p>Given these tables:<br />
Faculty (facId, name, department, rank)<br />
Class (classNumber, facId, schedule, room)<br />
ENROLL (stuId, classNumber, grade)<br />
Student (stuId, lastName, firstName, major, credits)  </p>

<p>Student and Class is a &#8220;has many&#8221; relationship. Students have many classes and the reverse, Classes have many Students. ENROLL is the relation between the two in an E-R model, and also called a pivot table.<br />
Find stuId and grade of all students taking any course taught by the Faculty member whose facId is F110. Arrange in order by stuId. 
&#8220;` bash  </p>

<p>SELECT Student.stuId, Student.lastName, ENROLL.grade major 
    FROM Class, ENROLL, Student 
    WHERE Class.facId=&#8221;F110&#8221; AND Class.classNumber=ENROLL.classNumber 
    AND ENROLL.stuId=Student.stuId ORDER BY Student.stuId;</p>

<p>or using JOIN</p>

<p>SELECT Student.stuId, ENROLL.grade 
    FROM Student LEFT JOIN ENROLL on (Student.stuId = ENROLL.stuId)
    WHERE ENROLL.classNumber IN 
        (SELECT Class.classNumber FROM Class WHERE facId=&#8221;F110&#8221;)
            ORDER BY Student.stuId;</p>

<p>+&#8212;&#8212;&#8212;-+&#8212;&#8212;&#8212;&#8212;&#8212;+&#8212;&#8212;&#8212;-+
| stuId | lastName | major |
+&#8212;&#8212;&#8212;-+&#8212;&#8212;&#8212;&#8212;&#8212;+&#8212;&#8212;&#8212;-+
| S1002 | Chin     | B     |
| S1010 | Burns    | NULL  |
| S1020 | Rivera   | A     |
+&#8212;&#8212;&#8212;-+&#8212;&#8212;&#8212;&#8212;&#8212;+&#8212;&#8212;&#8212;-+
&#8220;`</p>

<p>Find IDs and names of all students taking ART 103A:
&#8220;` bash<br />
SELECT ENROLL.stuID, lastName, firstName 
    FROM Student, ENROLL WHERE classNumber=&#8221;ART103A&#8221; 
    AND ENROLL.stuId=Student.stuId;</p>

<p>or using JOIN</p>

<p>SELECT Student.stuId, lastName, firstName 
    FROM Student JOIN ENROLL on ENROLL.stuId=Student.stuId 
    WHERE ENROLL.classNumber=&#8221;Art103A&#8221;;</p>

<p>+&#8212;&#8212;&#8212;-+&#8212;&#8212;&#8212;&#8212;&#8212;+&#8212;&#8212;&#8212;&#8212;&#8212;-+
| stuID | lastName | firstName |
+&#8212;&#8212;&#8212;-+&#8212;&#8212;&#8212;&#8212;&#8212;+&#8212;&#8212;&#8212;&#8212;&#8212;-+
| S1001 | Smith    | Tom       |
| S1002 | Chin     | Ann       |
| S1010 | Burns    | Edward    |
+&#8212;&#8212;&#8212;-+&#8212;&#8212;&#8212;&#8212;&#8212;+&#8212;&#8212;&#8212;&#8212;&#8212;-+
&#8220;`</p>

<p>Find the class numbers of all the courses taught by Byrne of the math department:<br />
&#8220;` bash
SELECT Class.classNumber FROM Class, Faculty WHERE Class.facId = Faculty.facId AND Faculty.name = &#8220;Byrne&#8221;;</p>

<pre><code>OR with a JOIN
</code></pre>

<p>SELECT Class.classNumber FROM Class JOIN Faculty ON Class.facId=Faculty.facId WHERE Faculty.name=&#8221;Byrne&#8221;;
&#8220;`</p>

<p>Find the names and IDs of all Faculty members who teach in class in Room H221:
&#8220;` bash
SELECT f.facId, f.name FROM Faculty f, Class c
    WHERE f.facId=c.facId AND c.room = &#8220;H221&#8221;;</p>

<pre><code>OR with JOIN
</code></pre>

<p>SELECT f.facId, f.name FROM Faculty f 
    JOIN Class c ON f.facId=c.facId WHERE c.room = &#8220;H221&#8221;;
&#8220;`</p>

<p>Get an alphabetical list of names and IDs of all students in any class taught by F110.
&#8220;` bash 
SELECT s.stuId, s.lastName FROM Student s, ENROLL e, Class c
WHERE s.stuId=e.stuId AND e.classNumber=c.classNumber 
AND c.facId=&#8221;F110&#8221; GROUP BY s.lastName ORDER BY s.lastName;</p>

<pre><code>OR using IN
</code></pre>

<p>SELECT lastName, firstName, stuId
 FROM Student
 WHERE stuId IN (SELECT stuId
 FROM ENROLL 
WHERE classNumber IN 
(SELECT classNumber 
FROM Class 
WHERE facId=&#8217;F110&#8217;)) 
ORDER by lastName, firstName ASC; 
&#8220;`</p>

<p>Find the name of all students enrolled in CSC201A. Using Exists:
&#8220;` bash
SELECT s.lastName, s.firstName FROM Student s 
    WHERE Exists (SELECT * FROM ENROLL e
    WHERE e.stuId=s.stuId And e.classNumber =&#8217;CSC201A&#8217;); </p>

<pre><code>OR with a JOIN (can't use IN since the tables have been joined)
</code></pre>

<p>SELECT s.lastName, s.firstName FROM Student s JOIN ENROLL e ON s.stuId=e.stuId WHERE e.classNumber=&#8221;CSC201A&#8221;;
&#8220;`</p>

<p>Find the names of all students who are not enrolled in CSC201A. (Can&#8217;t use a join or an IN subquery)
<code>bash
SELECT lastName, firstName FROM Student
 WHERE Not Exists (SELECT * FROM ENROLL
WHERE Student.stuId = ENROLL.stuId And classNumber ='CSC201A');</code></p>

          </article>
                    <p class="categories">
            Categories:
                        <a href="/blog/categories/SQL">SQL</a>,                         <a href="/blog/categories/MySQL">MySQL</a>                        </p>
                
          			</div>
	   </div>
    </div>

    <footer>
	<div class="container">
					</div>
</footer>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>


  </body>
</html>